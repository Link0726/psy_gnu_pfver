<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>스트레스 검사 결과</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
      html,
      body {
        height: 100%;
      }
      .gauge {
        --gdeg: 0deg;
        --gcolor: #16a34a;
        background: conic-gradient(var(--gcolor) var(--gdeg), #e5e7eb 0);
      }
    </style>
  </head>
  <body class="bg-gradient-to-b from-white to-pink-50 text-gray-800">
    <div class="max-w-3xl mx-auto px-5 py-10">
      <header class="mb-8">
        <h1 class="text-2xl sm:text-3xl md:text-4xl font-extrabold">
          스트레스 검사 결과
        </h1>
        <p class="mt-2 text-sm text-gray-600">총점은 0~40점 범위입니다.</p>
      </header>

      <!-- 결과 카드 -->
      <section
        class="rounded-2xl border border-gray-200 bg-white p-6 shadow-sm"
      >
        <div class="flex items-center justify-between gap-4">
          <div class="flex items-center gap-4">
            <!-- 원형 게이지 -->
            <div id="gauge" class="gauge w-24 h-24 rounded-full relative">
              <div
                class="absolute inset-2 rounded-full bg-white flex items-center justify-center"
              >
                <div class="text-center">
                  <div class="text-xs text-gray-500">총점</div>
                  <div id="score" class="text-2xl font-extrabold">0</div>
                </div>
              </div>
            </div>
            <div>
              <div class="text-sm text-gray-500">판정</div>
              <div id="label" class="text-xl font-bold" aria-live="polite">
                -
              </div>
              <div id="hint" class="mt-1 text-xs text-gray-500"></div>
            </div>
          </div>

          <!-- 범례 -->
          <div class="hidden sm:flex flex-col items-end gap-1 text-xs">
            <span class="inline-flex items-center gap-2"
              ><span
                class="inline-block w-2 h-2 rounded-full bg-green-600"
              ></span>
              0–13 정상</span
            >
            <span class="inline-flex items-center gap-2"
              ><span
                class="inline-block w-2 h-2 rounded-full bg-amber-500"
              ></span>
              14–16 영향 시작</span
            >
            <span class="inline-flex items-center gap-2"
              ><span
                class="inline-block w-2 h-2 rounded-full bg-orange-500"
              ></span>
              17–18 발전 가능성 높음</span
            >
            <span class="inline-flex items-center gap-2"
              ><span
                class="inline-block w-2 h-2 rounded-full bg-rose-600"
              ></span>
              19+ 전문가 도움 필요</span
            >
          </div>
        </div>

        <!-- 진행바 -->
        <div class="mt-4">
          <div class="h-2 w-full rounded-full bg-gray-200 overflow-hidden">
            <div id="bar" class="h-2 w-0 rounded-full transition-all"></div>
          </div>
          <div class="mt-1 text-xs text-gray-500" id="barText">0 / 40</div>
        </div>

        <!-- 자가진단 가이드 -->
        <div class="mt-6 border rounded-md overflow-hidden">
          <div class="bg-black text-white px-4 py-2 text-sm font-semibold">
            스트레스 자가 진단 가이드
          </div>
          <div class="bg-white px-4 py-4 text-sm">
            <ul class="list-disc pl-5 leading-7">
              <li>
                <span class="font-semibold">19점 이상</span> : 전문가의 도움이
                필요한 상태
              </li>
              <li>
                <span class="font-semibold">17–18점</span> : 정신질환으로 발전될
                가능성이 높아진 상태
              </li>
              <li>
                <span class="font-semibold">14–16점</span> : 스트레스의 영향을
                받기 시작
              </li>
              <li>
                <span class="font-semibold">13점 이하</span> : 정상적인 스트레스
                상태
              </li>
            </ul>
            <p class="mt-3 text-xs text-gray-500">
              ※ 본 결과는 선별(스크리닝) 용도로만 사용되며, 진단이 아닙니다.
              우려가 있다면 전문가와 상담하세요.
            </p>
          </div>
        </div>

        <!-- 버튼 -->
        <div class="mt-6 flex flex-wrap gap-3">
          <button
            id="copyBtn"
            class="rounded-xl border border-gray-300 bg-white px-4 py-2 text-sm hover:bg-gray-50"
          >
            결과 복사
          </button>
          <button
            id="shareBtn"
            class="rounded-xl border border-gray-300 bg-white px-4 py-2 text-sm hover:bg-gray-50"
          >
            공유하기
          </button>
          <a
            href="test1.html"
            class="rounded-xl bg-pink-500 text-white px-4 py-2 text-sm font-semibold hover:bg-pink-600"
            >다시 검사</a
          >
          <a
            href="index.html"
            class="rounded-xl border border-gray-300 bg-white px-4 py-2 text-sm hover:bg-gray-50"
            >검사 선택으로</a
          >
        </div>
      </section>

      <!-- 🔽 사진처럼: 설명 섹션들 -->
      <section
        class="mt-8 rounded-2xl border border-gray-200 bg-white p-6 shadow-sm"
      >
        <h2 class="text-lg font-bold">스트레스란?</h2>
        <p class="mt-3 text-sm leading-7 text-gray-700">
          일상생활 속에서 존재하는 외적 자극에 대한 신체적·정신적 반응입니다.
          모든 스트레스가 나쁜 것은 아니며, 생활 속 적당한 긴장감은 생기를 주고
          성취욕구와 에너지를 일깨우는 긍정적 역할을 하기도 합니다. 즉, 적당한
          스트레스는 삶의 활력을 유지하는 원동력이 될 수 있으나, 지나치면 여러
          문제를 초래할 수 있습니다.
        </p>

        <!-- 긍·부정 영향 표 -->
        <div class="mt-6">
          <div class="rounded-xl border border-gray-200 overflow-hidden">
            <div class="grid grid-cols-3 text-sm font-semibold bg-gray-50">
              <div class="p-3">구분</div>
              <div class="p-3">긍정적 영향</div>
              <div class="p-3">부정적 영향</div>
            </div>
            <div class="grid grid-cols-3 text-sm">
              <div class="p-3 border-t font-semibold">신체상</div>
              <div class="p-3 border-t">신체 능력 향상, 밝은 인상</div>
              <div class="p-3 border-t">
                신체질환 발생·악화 가능성, 질병 취약성 증가
              </div>

              <div class="p-3 border-t font-semibold">행동상</div>
              <div class="p-3 border-t">생산성 향상, 인내심 강화</div>
              <div class="p-3 border-t">
                안전 부주의, 과식·과음 등 불건강한 행동
              </div>

              <div class="p-3 border-t font-semibold">
                심리·정서(정신건강)상
              </div>
              <div class="p-3 border-t">
                생활에 활력 부여, 어려움 극복을 돕는 동기
              </div>
              <div class="p-3 border-t">
                불안·우울 발생, 각종 정신질환의 위험
              </div>
            </div>
          </div>
        </div>

        <!-- 관리법 -->
        <div class="mt-6">
          <h3 class="text-lg font-bold">스트레스 관리법</h3>
          <ol class="mt-2 list-decimal pl-5 text-sm leading-7">
            <li>
              <span class="font-semibold">유연한 사고(마인드)</span> — 완벽집착
              내려놓기, “충분히 괜찮다” 관점 연습.
            </li>
            <li>
              <span class="font-semibold">건강한 긍정 연습</span> — 사실 기반의
              긍정적 자기대화, 감사 일기 등.
            </li>
            <li>
              <span class="font-semibold">기타 관리법</span> — 복식호흡, 규칙적
              생활, 산책 및 운동, 취미생활, 적극적 대인관계, 긍정적 사고방식,
              전문가 상담·치료 등.
            </li>
          </ol>
        </div>
      </section>
    </div>

    <!-- 토스트 -->
    <div
      id="toast"
      class="fixed bottom-4 left-1/2 -translate-x-1/2 px-3 py-2 bg-gray-900 text-white text-sm rounded-lg shadow opacity-0 pointer-events-none transition-opacity duration-300"
    >
      복사했어요!
    </div>

    <script>
      function getScoreFromQuery() {
        const params = new URLSearchParams(location.search);
        const raw = params.get("score");
        const s = parseInt(raw, 10);
        if (!Number.isFinite(s)) return 0;
        return Math.max(0, Math.min(40, s));
      }
      function getUI(score) {
        if (score >= 19)
          return {
            label: "전문가 도움 필요",
            color: "#e11d48",
            barClass: "bg-rose-600",
          };
        if (score >= 17)
          return {
            label: "발전 가능성 높아짐",
            color: "#f97316",
            barClass: "bg-orange-500",
          };
        if (score >= 14)
          return {
            label: "영향 받기 시작",
            color: "#f59e0b",
            barClass: "bg-amber-500",
          };
        return {
          label: "정상 범위",
          color: "#16a34a",
          barClass: "bg-green-600",
        };
      }
      function showToast(msg = "복사했어요!") {
        const t = document.getElementById("toast");
        t.textContent = msg;
        t.classList.remove("opacity-0");
        t.classList.add("opacity-100");
        setTimeout(() => {
          t.classList.add("opacity-0");
          t.classList.remove("opacity-100");
        }, 1500);
      }

      const score = getScoreFromQuery();
      const ui = getUI(score);

      document.getElementById("score").textContent = String(score);
      const labelEl = document.getElementById("label");
      labelEl.textContent = ui.label;
      labelEl.className = "text-xl font-bold";

      const params = new URLSearchParams(location.search);
      const hint = document.getElementById("hint");
      if (!params.has("score")) {
        hint.textContent = "점수 파라미터가 없어 0점으로 표시 중.";
      } else {
        const raw = parseInt(params.get("score"), 10);
        if (Number.isFinite(raw) && (raw < 0 || raw > 40)) {
          hint.textContent = "0~40 범위를 넘어 보정했습니다.";
        }
      }

      const deg = (score / 40) * 360;
      const gauge = document.getElementById("gauge");
      gauge.style.setProperty("--gdeg", deg + "deg");
      gauge.style.setProperty("--gcolor", ui.color);

      const pct = (score / 40) * 100;
      const bar = document.getElementById("bar");
      bar.style.width = pct + "%";
      bar.className = "h-2 rounded-full transition-all " + ui.barClass;
      document.getElementById("barText").textContent = `${score} / 40`;

      document.getElementById("copyBtn").addEventListener("click", async () => {
        const text = `스트레스 검사 결과\n총점: ${score} / 40\n판정: ${ui.label}`;
        try {
          await navigator.clipboard.writeText(text);
          showToast();
        } catch {
          showToast("복사 실패. 수동으로 복사해 주세요.");
        }
      });

      document
        .getElementById("shareBtn")
        .addEventListener("click", async () => {
          const shareData = {
            title: "스트레스 검사 결과",
            text: `총점: ${score} / 40\n판정: ${ui.label}`,
            url: location.href,
          };
          try {
            if (navigator.share) {
              await navigator.share(shareData);
            } else {
              await navigator.clipboard.writeText(
                `${shareData.title}\n${shareData.text}\n${shareData.url}`
              );
              showToast("공유 링크를 복사했어요!");
            }
          } catch {
            showToast("공유가 취소되었어요.");
          }
        });
    </script>
  </body>
</html>
